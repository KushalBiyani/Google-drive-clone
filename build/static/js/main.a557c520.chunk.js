(this["webpackJsonpgoogle-drive-clone"]=this["webpackJsonpgoogle-drive-clone"]||[]).push([[0],{83:function(e,t,r){"use strict";r.r(t);var n=r(2),c=r(0),a=r.n(c),s=r(26),i=r.n(s),l=r(19),o=r.n(l),d=r(28),j=r(10),u=r(88),b=r(97),h=r(89),p=r(92),O=r(90),f=r(14),x=r(48),m=(r(73),r(84),r(85),x.a.initializeApp({apiKey:"AIzaSyBp1nl5dWeEotykfDxWrPnJsv94631HC-A",authDomain:"drive-clone-70e41.firebaseapp.com",projectId:"drive-clone-70e41",storageBucket:"drive-clone-70e41.appspot.com",messagingSenderId:"751248894478",appId:"1:751248894478:web:e1bcd465f17f294049aa5f"})),g=m.firestore(),v={folders:g.collection("folders"),files:g.collection("files"),formatDoc:function(e){return Object(f.a)({id:e.id},e.data())},getCurrentTimestamp:x.a.firestore.FieldValue.serverTimestamp},w=m.storage(),y=m.auth(),N=a.a.createContext();function F(){return Object(c.useContext)(N)}function C(e){var t=e.children,r=Object(c.useState)(),a=Object(j.a)(r,2),s=a[0],i=a[1],l=Object(c.useState)(!0),o=Object(j.a)(l,2),d=o[0],u=o[1];Object(c.useEffect)((function(){return y.onAuthStateChanged((function(e){i(e),u(!1)}))}),[]);var b={currentUser:s,login:function(e,t){return y.signInWithEmailAndPassword(e,t)},signup:function(e,t){return y.createUserWithEmailAndPassword(e,t)},logout:function(){return y.signOut()},resetPassword:function(e){return y.sendPasswordResetEmail(e)},signInWithGoogle:function(){var e=new x.a.auth.GoogleAuthProvider;return y.signInWithPopup(e)},updateEmail:function(e){return s.updateEmail(e)},updatePassword:function(e){return s.updatePassword(e)}};return Object(n.jsx)(N.Provider,{value:b,children:!d&&t})}var k=r(13),P=r(12);function I(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useRef)(),a=F().signup,s=Object(c.useState)(""),i=Object(j.a)(s,2),l=i[0],f=i[1],x=Object(c.useState)(!1),m=Object(j.a)(x,2),g=m[0],v=m[1],w=Object(k.g)();function y(){return(y=Object(d.a)(o.a.mark((function n(c){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c.preventDefault(),r.current.value===t.current.value){n.next=3;break}return n.abrupt("return",f("Password do not match"));case 3:return n.prev=3,f(""),v(!0),n.next=8,a(e.current.value,t.current.value);case 8:w.push("/"),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(3),f(l);case 14:v(!1);case 15:case"end":return n.stop()}}),n,null,[[3,11]])})))).apply(this,arguments)}return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(u.a,{className:"d-flex aling-item-center justify-content-center",style:{minHeight:"100vh"},children:Object(n.jsxs)("div",{className:"w-100",style:{maxWidth:"400px"},children:[Object(n.jsx)(b.a,{children:Object(n.jsxs)(b.a.Body,{children:[Object(n.jsx)("h2",{className:"text-center mb-4",children:"Sign Up"}),l&&Object(n.jsxs)(h.a,{variant:"danger",children:[" ",l," "]}),Object(n.jsxs)(p.a,{onSubmit:function(e){return y.apply(this,arguments)},children:[Object(n.jsxs)(p.a.Group,{id:"email",children:[Object(n.jsx)(p.a.Label,{children:"Email"}),Object(n.jsx)(p.a.Control,{type:"email",ref:e,autoComplete:"on",required:!0})]}),Object(n.jsxs)(p.a.Group,{id:"password",children:[Object(n.jsx)(p.a.Label,{children:"Password"}),Object(n.jsx)(p.a.Control,{type:"password",ref:t,autoComplete:"current-password",required:!0})]}),Object(n.jsxs)(p.a.Group,{id:"password-confirm",children:[Object(n.jsx)(p.a.Label,{children:"Password Confirmation"}),Object(n.jsx)(p.a.Control,{type:"password",ref:r,autoComplete:"current-password",required:!0})]}),Object(n.jsx)(O.a,{disabled:g,className:"w-100",type:"submit",children:"Sign Up"})]})]})}),Object(n.jsxs)("div",{className:"w-100 text-center mt-2",children:["Already have an account? ",Object(n.jsx)(P.b,{to:"/login",children:"Log In"})]})]})})})}function S(){var e=Object(c.useState)(""),t=Object(j.a)(e,2),r=t[0],a=t[1],s=F(),i=s.currentUser,l=s.logout,p=Object(k.g)();function f(){return(f=Object(d.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(""),e.prev=1,e.next=4,l();case 4:p.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),a("Failed to log out");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(u.a,{className:"d-flex aling-item-center justify-content-center",style:{minHeight:"100vh"},children:Object(n.jsxs)("div",{className:"w-100",style:{maxWidth:"400px"},children:[Object(n.jsx)(b.a,{children:Object(n.jsxs)(b.a.Body,{children:[Object(n.jsx)("img",{src:i.photoURL}),Object(n.jsx)("h2",{className:"text-center mb-4",children:"Profile"}),r&&Object(n.jsx)(h.a,{variant:"danger",children:r}),Object(n.jsxs)("h5",{children:[Object(n.jsx)("strong",{children:"Email:"})," ",i.email]}),Object(n.jsxs)("h5",{children:[Object(n.jsx)("strong",{children:"User Name:"})," ",i.displayName]}),Object(n.jsxs)("h5",{children:[Object(n.jsx)("strong",{children:"Phone Number:"})," ",i.phoneNumber]}),Object(n.jsx)(P.b,{to:"/update-profile",className:"btn btn-primary w-100 mt-3",children:"Update Profile"})]})}),Object(n.jsx)("div",{className:"w-100 text-center mt-2",children:Object(n.jsx)(O.a,{variant:"link",onClick:function(){return f.apply(this,arguments)},children:"Log Out"})})]})})})}function L(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=F(),a=r.login,s=r.signInWithGoogle,i=Object(c.useState)(""),l=Object(j.a)(i,2),f=l[0],x=l[1],m=Object(c.useState)(!1),g=Object(j.a)(m,2),v=g[0],w=g[1],y=Object(k.g)();function N(){return(N=Object(d.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x(""),w(!0),e.next=5,s();case 5:y.push("/"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),x("Failed to log in");case 11:w(!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function C(){return(C=Object(d.a)(o.a.mark((function r(n){return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.preventDefault(),r.prev=1,x(""),w(!0),r.next=6,a(e.current.value,t.current.value);case 6:y.push("/"),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(1),x("Failed to log in");case 12:w(!1);case 13:case"end":return r.stop()}}),r,null,[[1,9]])})))).apply(this,arguments)}return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(u.a,{className:"d-flex aling-item-center justify-content-center",style:{minHeight:"100vh"},children:Object(n.jsxs)("div",{className:"w-100",style:{maxWidth:"400px"},children:[Object(n.jsx)(b.a,{children:Object(n.jsxs)(b.a.Body,{children:[Object(n.jsx)("h2",{className:"text-center mb-4",children:"Log In"}),f&&Object(n.jsx)(h.a,{variant:"danger",children:f}),Object(n.jsxs)(p.a,{onSubmit:function(e){return C.apply(this,arguments)},children:[Object(n.jsxs)(p.a.Group,{id:"email",children:[Object(n.jsx)(p.a.Label,{children:"Email"}),Object(n.jsx)(p.a.Control,{type:"email",ref:e,autoComplete:"username",required:!0})]}),Object(n.jsxs)(p.a.Group,{id:"password",children:[Object(n.jsx)(p.a.Label,{children:"Password"}),Object(n.jsx)(p.a.Control,{type:"password",ref:t,autoComplete:"current-password",required:!0})]}),Object(n.jsx)(O.a,{disabled:v,className:"w-100",type:"submit",children:"Log In"})]}),Object(n.jsxs)(O.a,{className:"login-provider-button w-100",onClick:function(){return N.apply(this,arguments)},children:[Object(n.jsx)("img",{src:"https://img.icons8.com/ios-filled/50/000000/google-logo.png",alt:"google icon"}),Object(n.jsx)("span",{children:" Continue with Google"})]}),Object(n.jsx)("div",{className:"w-100 text-center mt-3",children:Object(n.jsx)(P.b,{to:"/forgot-password",children:"Forgot Password?"})})]})}),Object(n.jsxs)("div",{className:"w-100 text-center mt-2",children:["Need an account? ",Object(n.jsx)(P.b,{to:"/signup",children:"Sign Up"})]})]})})})}var E=r(66);function U(e){var t=e.component,r=Object(E.a)(e,["component"]),c=F().currentUser;return Object(n.jsx)(k.b,Object(f.a)(Object(f.a)({},r),{},{render:function(e){return c?Object(n.jsx)(t,Object(f.a)({},e)):Object(n.jsx)(k.a,{to:"/login"})}}))}function W(){var e=Object(c.useRef)(),t=F().resetPassword,r=Object(c.useState)(""),a=Object(j.a)(r,2),s=a[0],i=a[1],l=Object(c.useState)(""),f=Object(j.a)(l,2),x=f[0],m=f[1],g=Object(c.useState)(!1),v=Object(j.a)(g,2),w=v[0],y=v[1];function N(){return(N=Object(d.a)(o.a.mark((function r(n){return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.preventDefault(),r.prev=1,m(""),i(""),y(!0),r.next=7,t(e.current.value);case 7:m("Check your inbox for further instructions"),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(1),i("Failed to reset password");case 13:y(!1);case 14:case"end":return r.stop()}}),r,null,[[1,10]])})))).apply(this,arguments)}return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(u.a,{className:"d-flex aling-item-center justify-content-center",style:{minHeight:"100vh"},children:Object(n.jsxs)("div",{className:"w-100",style:{maxWidth:"400px"},children:[Object(n.jsx)(b.a,{children:Object(n.jsxs)(b.a.Body,{children:[Object(n.jsx)("h2",{className:"text-center mb-4",children:"Password Reset"}),s&&Object(n.jsx)(h.a,{variant:"danger",children:s}),x&&Object(n.jsx)(h.a,{variant:"success",children:x}),Object(n.jsxs)(p.a,{onSubmit:function(e){return N.apply(this,arguments)},children:[Object(n.jsxs)(p.a.Group,{id:"email",children:[Object(n.jsx)(p.a.Label,{children:"Email"}),Object(n.jsx)(p.a.Control,{type:"email",ref:e,required:!0})]}),Object(n.jsx)(O.a,{disabled:w,className:"w-100",type:"submit",children:"Reset Password"})]}),Object(n.jsx)("div",{className:"w-100 text-center mt-3",children:Object(n.jsx)(P.b,{to:"/login",children:"Login"})})]})}),Object(n.jsxs)("div",{className:"w-100 text-center mt-2",children:["Need an account? ",Object(n.jsx)(P.b,{to:"/signup",children:"Sign Up"})]})]})})})}function R(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useRef)(),a=F(),s=a.currentUser,i=a.updatePassword,l=a.updateEmail,o=Object(c.useState)(""),d=Object(j.a)(o,2),f=d[0],x=d[1],m=Object(c.useState)(!1),g=Object(j.a)(m,2),v=g[0],w=g[1],y=Object(k.g)();return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(u.a,{className:"d-flex aling-item-center justify-content-center",style:{minHeight:"100vh"},children:Object(n.jsxs)("div",{className:"w-100",style:{maxWidth:"400px"},children:[Object(n.jsx)(b.a,{children:Object(n.jsxs)(b.a.Body,{children:[Object(n.jsx)("h2",{className:"text-center mb-4",children:"Update Profile"}),f&&Object(n.jsx)(h.a,{variant:"danger",children:f}),Object(n.jsxs)(p.a,{onSubmit:function(n){if(n.preventDefault(),t.current.value!==r.current.value)return x("Passwords do not match");var c=[];w(!0),x(""),e.current.value!==s.email&&c.push(l(e.current.value)),t.current.value&&c.push(i(t.current.value)),Promise.all(c).then((function(){y.push("/")})).catch((function(){x("Failed to update account")})).finally((function(){w(!1)}))},children:[Object(n.jsxs)(p.a.Group,{id:"email",children:[Object(n.jsx)(p.a.Label,{children:"Email"}),Object(n.jsx)(p.a.Control,{type:"email",ref:e,required:!0,defaultValue:s.email})]}),Object(n.jsxs)(p.a.Group,{id:"password",children:[Object(n.jsx)(p.a.Label,{children:"Password"}),Object(n.jsx)(p.a.Control,{type:"password",ref:t,placeholder:"Leave blank to keep the same"})]}),Object(n.jsxs)(p.a.Group,{id:"password-confirm",children:[Object(n.jsx)(p.a.Label,{children:"Password Confirmation"}),Object(n.jsx)(p.a.Control,{type:"password",ref:r,placeholder:"Leave blank to keep the same"})]}),Object(n.jsx)(O.a,{disabled:v,className:"w-100",type:"submit",children:"Update"})]})]})}),Object(n.jsx)("div",{className:"w-100 text-center mt-2",children:Object(n.jsx)(P.b,{to:"/",children:"Cancel"})})]})})})}var B="select-folder",D="update-folder",G="set-child-folders",A="set-child-files",q={name:"Root",id:null,path:[]};function H(e,t){var r=t.type,n=t.payload;switch(r){case B:return{folderId:n.folderId,folder:n.folder,childFiles:[],childFolders:[]};case D:return Object(f.a)(Object(f.a)({},e),{},{folder:n.folder});case G:return Object(f.a)(Object(f.a)({},e),{},{childFolders:n.childFolders});case A:return Object(f.a)(Object(f.a)({},e),{},{childFiles:n.childFiles});default:return e}}var T=r(41),z=r(91),J=r(34),K=r(35);function M(e){var t=e.currentFolder,r=Object(c.useState)(!1),a=Object(j.a)(r,2),s=a[0],i=a[1],l=Object(c.useState)(""),o=Object(j.a)(l,2),d=o[0],u=o[1],b=F().currentUser;function h(){i(!1)}return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(O.a,{onClick:function(){i(!0)},variant:"outline-success",size:"sm",children:Object(n.jsx)(J.a,{icon:K.d})}),Object(n.jsx)(z.a,{show:s,onHide:h,children:Object(n.jsxs)(p.a,{onSubmit:function(e){if(e.preventDefault(),null!=t){var r=Object(T.a)(t.path);t!==q&&r.push({name:t.name,id:t.id}),v.folders.add({name:d,parentId:t.id,userId:b.uid,path:r,createdAt:v.getCurrentTimestamp()}),u(""),h()}},children:[Object(n.jsx)(z.a.Body,{children:Object(n.jsxs)(p.a.Group,{children:[Object(n.jsx)(p.a.Label,{children:"Folder Name"}),Object(n.jsx)(p.a.Control,{type:"text",required:!0,value:d,onChange:function(e){return u(e.target.value)}})]})}),Object(n.jsxs)(z.a.Footer,{children:[Object(n.jsx)(O.a,{variant:"secondary",onClick:h,children:"Close"}),Object(n.jsx)(O.a,{variant:"success",type:"submit",children:"Add Folder"})]})]})})]})}var V=r(96),_=r(94),Q=r(98);function X(e){var t=e.currentFolder,r=Object(c.useState)([]),a=Object(j.a)(r,2),s=a[0],l=a[1],o=F().currentUser;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("label",{className:"btn btn-outline-success btn-sm m-0 mr-2",children:[Object(n.jsx)(J.a,{icon:K.b}),Object(n.jsx)("input",{type:"file",onChange:function(e){var r=e.target.files[0];if(null!=t&&null!=r){var n=Object(V.a)();l((function(e){return[].concat(Object(T.a)(e),[{id:n,name:r.name,progress:0,error:!1}])}));var c=t===q?"".concat(t.path.join("/"),"/").concat(r.name):"".concat(t.path.join("/"),"/").concat(t.name,"/").concat(r.name),a=w.ref("/files/".concat(o.uid,"/").concat(c)).put(r);a.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes;l((function(e){return e.map((function(e){return e.id===n?Object(f.a)(Object(f.a)({},e),{},{progress:t}):e}))}))}),(function(){l((function(e){return e.map((function(e){return e.id===n?Object(f.a)(Object(f.a)({},e),{},{error:!0}):e}))}))}),(function(){l((function(e){return e.filter((function(e){return e.id!==n}))})),a.snapshot.ref.getDownloadURL().then((function(e){v.files.where("name","==",r.name).where("userId","==",o.uid).where("folderId","==",t.id).get().then((function(n){var c=n.docs[0];c?c.ref.update({url:e}):v.files.add({url:e,name:r.name,createdAt:v.getCurrentTimestamp(),folderId:t.id,userId:o.uid})}))}))}))}},style:{opacity:0,position:"absolute",left:"-9999px"}})]}),s.length>0&&i.a.createPortal(Object(n.jsx)("div",{style:{position:"absolute",bottom:"1rem",right:"1rem",maxWidth:"250px"},children:s.map((function(e){return Object(n.jsxs)(_.a,{onClose:function(){l((function(t){return t.filter((function(t){return t.id!==e.id}))}))},children:[Object(n.jsx)(_.a.Header,{closeButton:e.error,className:"text-truncate w-100 d-block",children:e.name}),Object(n.jsx)(_.a.Body,{children:Object(n.jsx)(Q.a,{animated:!e.error,variant:e.error?"danger":"primary",now:e.error?100:100*e.progress,label:e.error?"Error":"".concat(Math.round(100*e.progress),"%")})})]},e.id)}))}),document.body)]})}function Y(e){var t=e.folder;return Object(n.jsxs)(O.a,{to:{pathname:"/folder/".concat(t.id),state:{folder:t}},variant:"outline-dark",className:"text-truncate w-100",as:P.b,children:[Object(n.jsx)(J.a,{icon:K.c,className:"mr-2"}),t.name]})}function Z(e){var t=e.file;return Object(n.jsxs)("a",{href:t.url,target:"_blank",className:"btn btn-outline-dark text-truncate w-100",children:[Object(n.jsx)(J.a,{icon:K.a,className:"mr-2"}),t.name]})}var $=r(95),ee=r(93);function te(){return Object(n.jsxs)($.a,{bg:"light",expand:"sm",children:[Object(n.jsx)($.a.Brand,{as:P.b,to:"/",children:"Welcome to Kushal's Drive"}),Object(n.jsx)(ee.a,{children:Object(n.jsx)(ee.a.Link,{as:P.b,to:"/user",children:"Profile"})})]})}var re=r(99);function ne(e){var t=e.currentFolder,r=t===q?[]:[q];return t&&(r=[].concat(Object(T.a)(r),Object(T.a)(t.path))),Object(n.jsxs)(re.a,{className:"flex-grow-1",listProps:{className:"bg-white pl-0 m-0"},children:[r.map((function(e,t){return Object(n.jsx)(re.a.Item,{linkAs:P.b,linkProps:{to:{pathname:e.id?"/folder/".concat(e.id):"/",state:{folder:Object(f.a)(Object(f.a)({},e),{},{path:r.slice(1,t)})}}},className:"text-truncate d-inline-block",style:{maxWidth:"150px"},children:e.name},e.id)})),t&&Object(n.jsx)(re.a.Item,{className:"text-truncate d-inline-block",style:{maxWidth:"200px"},active:!0,children:t.name})]})}function ce(){var e=Object(k.i)().folderId,t=Object(k.h)().state,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=Object(c.useReducer)(H,{folderId:e,folder:t,childFolders:[],childFiles:[]}),n=Object(j.a)(r,2),a=n[0],s=n[1],i=F().currentUser;return Object(c.useEffect)((function(){s({type:B,payload:{folderId:e,folder:t}})}),[e,t]),Object(c.useEffect)((function(){if(null==e)return s({type:D,payload:{folder:q}});v.folders.doc(e).get().then((function(e){s({type:D,payload:{folder:v.formatDoc(e)}})})).catch((function(){s({type:D,payload:{folder:q}})}))}),[e]),Object(c.useEffect)((function(){return v.folders.where("parentId","==",e).where("userId","==",i.uid).orderBy("createdAt").onSnapshot((function(e){s({type:G,payload:{childFolders:e.docs.map(v.formatDoc)}})}))}),[e,i]),Object(c.useEffect)((function(){return v.files.where("folderId","==",e).where("userId","==",i.uid).onSnapshot((function(e){s({type:A,payload:{childFiles:e.docs.map(v.formatDoc)}})}))}),[e,i]),a}(e,(void 0===t?{}:t).folder),a=r.folder,s=r.childFolders,i=r.childFiles;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(te,{}),Object(n.jsxs)(u.a,{fluid:!0,children:[Object(n.jsxs)("div",{className:"d-flex align-items-center",children:[Object(n.jsx)(ne,{currentFolder:a}),Object(n.jsx)(X,{currentFolder:a}),Object(n.jsx)(M,{currentFolder:a})]}),s.length>0&&Object(n.jsx)("div",{className:"d-flex flex-wrap",children:s.map((function(e){return Object(n.jsx)("div",{style:{maxWidth:"250px"},className:"p-2",children:Object(n.jsx)(Y,{folder:e})},e.id)}))}),s.length>0&&i.length>0&&Object(n.jsx)("hr",{}),i.length>0&&Object(n.jsx)("div",{className:"d-flex flex-wrap",children:i.map((function(e){return Object(n.jsx)("div",{style:{maxWidth:"250px"},className:"p-2",children:Object(n.jsx)(Z,{file:e})},e.id)}))})]})]})}var ae=function(){return Object(n.jsx)(P.a,{children:Object(n.jsx)(C,{children:Object(n.jsxs)(k.d,{children:[Object(n.jsx)(U,{exact:!0,path:"/",component:ce}),Object(n.jsx)(U,{exact:!0,path:"/folder/:folderId",component:ce}),Object(n.jsx)(U,{path:"/user",component:S}),Object(n.jsx)(U,{path:"/update-profile",component:R}),Object(n.jsx)(k.b,{path:"/signup",component:I}),Object(n.jsx)(k.b,{path:"/login",component:L}),Object(n.jsx)(k.b,{path:"/forgot-password",component:W})]})})})},se=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,100)).then((function(t){var r=t.getCLS,n=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;r(e),n(e),c(e),a(e),s(e)}))};r(82);i.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(ae,{})}),document.getElementById("root")),se()}},[[83,1,2]]]);
//# sourceMappingURL=main.a557c520.chunk.js.map